
	<!DOCTYPE HTML>
<html>
	<head>
    <meta charset="UTF-8">
	<title>
		Image To Text
	</title>	
	</head>
	<body>		
		<div class="bt">
			<form id="uf">
        <input type="file" name="file" id="up-button"/>
			<input type="button" id="button" value="选择图片"/>
	</form>
	</div>	
	<canvas id="cv">
		fuck ie
	</canvas>
	<div id="txt"></div>	
	</body>
</html>
    	<style>*{
	margin:0;
	padding:0}
body{
	font-size:12px;
	margin:10px;
	font-family:simsun;
	background:#fff}
p{
	height:12px}
p.ts{
	margin:10px 0 0 0;
	width:500px;
	float:left}
span{
	width:12px}
#cv,#txt{
	float:left}
#cv{
	margin-right:5px}
.bt{
	height:37px}
form,input{
	width:73px;
	height:27px}
form{
	position:relative;
	float:left;
	margin:0 10px 0 0}
#up-button{
	position:absolute;
	right:0;
	top:0;
	cursor:pointer;
	opacity:0;
	filter:alpha(opacity=0);
	outline:none}
#button{
}iframe{
	display:none}</style>
	    		<script>function toText(e) {
	return e <= 30 ? "8": e > 30 && e <= 60 ? "&": e > 60 && e <= 120 ? "$": e > 120 && e <= 150 ? "*": e > 150 && e <= 180 ? "o": e > 180 && e <= 210 ? "!": e > 210 && e <= 240 ? ";": "."
}
function getGray(e, t, n) {
	return .299 * e + .578 * t + .114 * n
}
function init() {
	txtDiv.style.width = img.width + "px",
	cv.width = img.width,
	cv.height = img.height,
	c.drawImage(img, 0, 0);
	var e = c.getImageData(0, 0, img.width, img.height),
	t = e.data,
	n = e.width,
	r = e.height,
	i = "";
	for (h = 0; h < r; h += 12) {
		var s = "<p>";
		for (w = 0; w < n; w += 6) {
			var o = (w + n * h) * 4,
			u = t[o + 0],
			a = t[o + 1],
			f = t[o + 2],
			l = getGray(u, a, f);
			s += toText(l)
		}
		s += "</p>",
		i += s
	}
	txtDiv.innerHTML = i
}
function getImg(e) {
	var t = new FileReader;
	t.readAsDataURL(fileBtn.files[0]),
	t.onload = function() {
		img.src = t.result
	}
}
var cv = document.getElementById("cv"),
c = cv.getContext("2d"),
txtDiv = document.getElementById("txt"),
fileBtn = document.getElementById("up-button"),
img = new Image;
img.src = "",
img.onload = init,
fileBtn.onchange = getImg</script>
	
<!-- Generated by RunJS (Wed Jun 22 15:30:01 CST 2016) 0ms -->